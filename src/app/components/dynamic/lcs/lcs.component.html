<div class="lcs-visualization">
  <div class="problem-info">
    <h4>ğŸ”¤ æœ€é•·å…±é€šéƒ¨åˆ†åˆ— (LCS)</h4>
    <div class="result-summary">{{ getResultText() }}</div>
    @if (isComplete) {
      <div class="similarity">
        <div class="similarity-bar">
          <div class="similarity-fill" [style.width.%]="getSimilarityPercentage()"></div>
        </div>
        <span>é¡ä¼¼åº¦: {{ getSimilarityPercentage() }}%</span>
      </div>
    }
  </div>

  <!-- æ–‡å­—åˆ—ã®è¡¨ç¤º -->
  <div class="strings-section">
    <div class="string-container">
      <div class="string-label">æ–‡å­—åˆ—1:</div>
      <div class="string-display">
        @for (char of string1.split(''); track $index) {
          <span [class]="getCharClass(1, $index)">{{ char }}</span>
        }
      </div>
    </div>
    
    <div class="string-container">
      <div class="string-label">æ–‡å­—åˆ—2:</div>
      <div class="string-display">
        @for (char of string2.split(''); track $index) {
          <span [class]="getCharClass(2, $index)">{{ char }}</span>
        }
      </div>
    </div>

    @if (currentRow > 0 && currentCol > 0) {
      <div class="current-comparison">
        <strong>ç¾åœ¨ã®æ¯”è¼ƒ:</strong> {{ getCurrentComparisonText() }}
      </div>
    }
  </div>

  <!-- DPãƒ†ãƒ¼ãƒ–ãƒ« -->
  <div class="dp-table-section">
    <h4>ğŸ“Š å‹•çš„ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ãƒ†ãƒ¼ãƒ–ãƒ«</h4>
    <div class="table-container">
      <table class="dp-table">
        <thead>
          <tr>
            <th class="corner-cell"></th>
            <th class="char-header">Îµ</th>
            @for (char of string2.split(''); track $index) {
              <th class="char-header">{{ char }}</th>
            }
          </tr>
        </thead>
        <tbody>
          @for (row of dpTable; track rowIndex; let rowIndex = $index) {
            <tr>
              <td class="row-header">
                @if (rowIndex === 0) {
                  Îµ
                } @else {
                  {{ string1[rowIndex - 1] }}
                }
              </td>
              @for (cell of row; track colIndex; let colIndex = $index) {
                <td 
                  [class]="getDPCellClass(rowIndex, colIndex)"
                  [attr.data-row]="rowIndex"
                  [attr.data-col]="colIndex">
                  {{ cell }}
                </td>
              }
            </tr>
          }
        </tbody>
      </table>
    </div>
  </div>

  <!-- çµæœè¡¨ç¤º -->
  @if (isComplete && lcsResult) {
    <div class="result-section">
      <h4>ğŸ¯ æœ€é•·å…±é€šéƒ¨åˆ†åˆ—</h4>
      <div class="lcs-result">
        <div class="lcs-string">
          @for (char of lcsResult.split(''); track $index) {
            <span class="lcs-char">{{ char }}</span>
          }
        </div>
        <div class="lcs-stats">
          <span>é•·ã•: {{ lcsLength }}</span>
          <span>æ–‡å­—åˆ—1ã¨ã®ä¸€è‡´ç‡: {{ Math.round((lcsLength / string1.length) * 100) }}%</span>
          <span>æ–‡å­—åˆ—2ã¨ã®ä¸€è‡´ç‡: {{ Math.round((lcsLength / string2.length) * 100) }}%</span>
        </div>
      </div>
    </div>
  }

  <div class="legend">
    <div class="legend-item">
      <div class="legend-color current"></div>
      <span>ç¾åœ¨è¨ˆç®—ä¸­</span>
    </div>
    <div class="legend-item">
      <div class="legend-color computed"></div>
      <span>è¨ˆç®—å®Œäº†</span>
    </div>
    <div class="legend-item">
      <div class="legend-color backtrack"></div>
      <span>ãƒãƒƒã‚¯ãƒˆãƒ©ãƒƒã‚¯çµŒè·¯</span>
    </div>
    <div class="legend-item">
      <div class="legend-color highlighted"></div>
      <span>LCSã«å«ã¾ã‚Œã‚‹æ–‡å­—</span>
    </div>
    <div class="legend-item">
      <div class="legend-color comparing"></div>
      <span>æ¯”è¼ƒä¸­ã®æ–‡å­—</span>
    </div>
  </div>
</div>