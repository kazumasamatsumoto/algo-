<div class="floyd-warshall-visualization">
  <div class="problem-info">
    <h4>ğŸŒ ãƒ•ãƒ­ã‚¤ãƒ‰ãƒ»ãƒ¯ãƒ¼ã‚·ãƒ£ãƒ«æ³• (å…¨ç‚¹å¯¾é–“æœ€çŸ­çµŒè·¯)</h4>
    <div class="result-summary">{{ getResultText() }}</div>
  </div>

  <!-- ç¾åœ¨ã®æ“ä½œè¡¨ç¤º -->
  @if (getCurrentOperationText()) {
    <div class="current-operation">
      <strong>ç¾åœ¨ã®æ¯”è¼ƒ:</strong> {{ getCurrentOperationText() }}
    </div>
  }

  <div class="main-content">
    <!-- ã‚°ãƒ©ãƒ•è¡¨ç¤º -->
    <div class="graph-section">
      <h4>ğŸ”— ã‚°ãƒ©ãƒ•æ§‹é€ </h4>
      <svg width="300" height="250" class="graph-svg">
        <!-- ã‚¨ãƒƒã‚¸ã‚’æç”» -->
        @for (edge of graph.edges; track edge) {
          <line
            [attr.x1]="getNodeX(edge.from)"
            [attr.y1]="getNodeY(edge.from)"
            [attr.x2]="getNodeX(edge.to)"
            [attr.y2]="getNodeY(edge.to)"
            [class]="getEdgeClass(edge.from, edge.to)"
          />
          <!-- ã‚¨ãƒƒã‚¸ã®é‡ã¿è¡¨ç¤º -->
          <text
            [attr.x]="(getNodeX(edge.from) + getNodeX(edge.to)) / 2"
            [attr.y]="(getNodeY(edge.from) + getNodeY(edge.to)) / 2"
            class="edge-weight">
            {{ edge.weight }}
          </text>
        }

        <!-- ãƒãƒ¼ãƒ‰ã‚’æç”» -->
        @for (node of graph.nodes; track node.id) {
          <g class="node-group">
            <circle
              [attr.cx]="node.x"
              [attr.cy]="node.y"
              r="18"
              [class]="getNodeClass(node.id)"
            />
            <text
              [attr.x]="node.x"
              [attr.y]="node.y + 5"
              class="node-id">
              {{ node.id }}
            </text>
          </g>
        }
      </svg>

      @if (currentK >= 0) {
        <div class="current-intermediate">
          <span class="intermediate-label">ä¸­é–“ãƒãƒ¼ãƒ‰:</span>
          <span class="intermediate-value">{{ currentK }}</span>
        </div>
      }
    </div>

    <!-- è·é›¢è¡Œåˆ— -->
    <div class="matrix-section">
      <h4>ğŸ“Š è·é›¢è¡Œåˆ—</h4>
      <div class="matrix-container">
        <table class="distance-matrix">
          <thead>
            <tr>
              <th class="corner-cell">From\\To</th>
              @for (node of graph.nodes; track node.id) {
                <th class="node-header">{{ node.id }}</th>
              }
            </tr>
          </thead>
          <tbody>
            @for (row of distanceMatrix; track rowIndex; let rowIndex = $index) {
              <tr>
                <td class="row-header">{{ rowIndex }}</td>
                @for (cell of row; track colIndex; let colIndex = $index) {
                  <td 
                    [class]="getCellClass(rowIndex, colIndex)"
                    (click)="selectPath(rowIndex, colIndex)">
                    {{ formatDistance(cell) }}
                  </td>
                }
              </tr>
            }
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- æœ€çŸ­çµŒè·¯ãƒªã‚¹ãƒˆ -->
  @if (isComplete && shortestPaths.length > 0) {
    <div class="paths-section">
      <h4>ğŸ›¤ï¸ å…¨ã¦ã®æœ€çŸ­çµŒè·¯</h4>
      <div class="paths-grid">
        @for (pathInfo of shortestPaths; track $index) {
          <div 
            class="path-item"
            [class.selected]="selectedPath?.from === pathInfo.from && selectedPath?.to === pathInfo.to"
            (click)="selectPath(pathInfo.from, pathInfo.to)">
            <div class="path-header">
              <span class="path-nodes">{{ pathInfo.from }} â†’ {{ pathInfo.to }}</span>
              <span class="path-distance">è·é›¢: {{ pathInfo.distance }}</span>
            </div>
            <div class="path-route">
              çµŒè·¯: {{ pathInfo.path.join(' â†’ ') }}
            </div>
          </div>
        }
      </div>
    </div>
  }

  <!-- ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ èª¬æ˜ -->
  <div class="algorithm-info">
    <h4>ğŸ“š ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã«ã¤ã„ã¦</h4>
    <div class="info-content">
      <div class="step-info">
        <strong>ãƒ•ãƒ­ã‚¤ãƒ‰ãƒ»ãƒ¯ãƒ¼ã‚·ãƒ£ãƒ«æ³•ã®æ‰‹é †:</strong>
        <ol>
          <li>å„ãƒãƒ¼ãƒ‰ã‹ã‚‰å„ãƒãƒ¼ãƒ‰ã¸ã®åˆæœŸè·é›¢ã‚’è¨­å®š</li>
          <li>å„ãƒãƒ¼ãƒ‰ã‚’ä¸­é–“ãƒãƒ¼ãƒ‰ã¨ã—ã¦é †ç•ªã«è€ƒæ…®</li>
          <li>ä¸­é–“ãƒãƒ¼ãƒ‰ã‚’çµŒç”±ã™ã‚‹çµŒè·¯ã®æ–¹ãŒçŸ­ã„å ´åˆã€è·é›¢ã‚’æ›´æ–°</li>
          <li>å…¨ã¦ã®ãƒãƒ¼ãƒ‰ãƒšã‚¢ã«ã¤ã„ã¦æœ€çŸ­è·é›¢ã‚’è¨ˆç®—</li>
        </ol>
      </div>
      <div class="complexity-info">
        <div class="complexity-item">
          <span class="label">æ™‚é–“è¨ˆç®—é‡:</span>
          <span class="value">O(VÂ³)</span>
        </div>
        <div class="complexity-item">
          <span class="label">ç©ºé–“è¨ˆç®—é‡:</span>
          <span class="value">O(VÂ²)</span>
        </div>
      </div>
    </div>
  </div>

  <!-- å‡¡ä¾‹ -->
  <div class="legend">
    <div class="legend-item">
      <div class="legend-color current"></div>
      <span>ç¾åœ¨æ¯”è¼ƒä¸­</span>
    </div>
    <div class="legend-item">
      <div class="legend-color involved"></div>
      <span>è¨ˆç®—ã«é–¢ä¸</span>
    </div>
    <div class="legend-item">
      <div class="legend-color intermediate"></div>
      <span>ä¸­é–“ãƒãƒ¼ãƒ‰</span>
    </div>
    <div class="legend-item">
      <div class="legend-color selected"></div>
      <span>é¸æŠã•ã‚ŒãŸçµŒè·¯</span>
    </div>
  </div>
</div>